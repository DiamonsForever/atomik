<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Atomik Framework</title>

    <link type="text/css" rel="stylesheet" href="/docs/assets/css/reset.css">
    <link type="text/css" rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/sunburst.min.css">
    <link type="text/css" rel="stylesheet" href="/docs/assets/css/docs.css">
    <link type="text/css" rel="stylesheet" href="/docs/assets/css/print.css" media="print">
    <link type="text/css" rel="stylesheet" href="style.css">

    <script type="text/javascript" src="/docs/assets/js/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
    <script type="text/javascript" src="/docs/assets/js/lunr.min.js"></script>

    

    <script type="text/javascript">var BASE_URL = "/docs/";</script>
    <script type="text/javascript" src="/docs/assets/js/viewer.js"></script>

    
</head>
<body>
    <div id="page">
        <a name="top" />
        <header id="header">
            <h1><a href="/docs/">Atomik Framework</a></h1>
        </header>
        

<div id="sidebar">
    <form action="/docs/search.html"><input id="search" type="text" placeholder="Search" name="q" /></form>
    <nav id="toc">
        
    <ol>
    
        <li>
            <a href="/docs/introduction.html#introduction">Introduction</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/introduction.html#requirements">Requirements</a>
            
        </li>
    
        <li>
            <a href="/docs/introduction.html#installation">Installation</a>
            
        </li>
    
        <li>
            <a href="/docs/introduction.html#about-the-skeleton">About the skeleton</a>
            
        </li>
    
        <li>
            <a href="/docs/introduction.html#directory-structure">Directory structure</a>
            
        </li>
    
        <li>
            <a href="/docs/introduction.html#advanced-installation">Advanced installation</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/get-started.html#get-started">Get started</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/get-started.html#the-database">The database</a>
            
        </li>
    
        <li>
            <a href="/docs/get-started.html#listing-posts">Listing posts</a>
            
        </li>
    
        <li>
            <a href="/docs/get-started.html#creating-new-posts">Creating new posts</a>
            
        </li>
    
        <li>
            <a href="/docs/get-started.html#viewing-a-post">Viewing a post</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/global-store.html#the-global-store">The global store</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/global-store.html#accessing-the-store">Accessing the store</a>
            
        </li>
    
        <li>
            <a href="/docs/global-store.html#nested-arrays">Nested arrays</a>
            
        </li>
    
        <li>
            <a href="/docs/global-store.html#accessing-the-global-store-from-actions-and-views">Accessing the global store from actions and views</a>
            
        </li>
    
        <li>
            <a href="/docs/global-store.html#using-accessors-with-any-array">Using accessors with any array</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/configuration.html#configuration">Configuration</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/configuration.html#configuration-file">Configuration file</a>
            
        </li>
    
        <li>
            <a href="/docs/configuration.html#bootsrapping">Bootsrapping</a>
            
        </li>
    
        <li>
            <a href="/docs/configuration.html#custom-directory-structure">Custom directory structure</a>
            
        </li>
    
        <li>
            <a href="/docs/configuration.html#pre-and-post-dispatch-files">Pre and post dispatch files</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/urls.html#urls">URLs</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/urls.html#calling-an-action">Calling an action</a>
            
        </li>
    
        <li>
            <a href="/docs/urls.html#routing-urls">Routing urls</a>
            
        </li>
    
        <li>
            <a href="/docs/urls.html#file-extensions">File extensions</a>
            
        </li>
    
        <li>
            <a href="/docs/urls.html#building-urls">Building urls</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/actions.html#actions">Actions</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/actions.html#introduction">Introduction</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#action-files">Action files</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#actions-and-http-methods">Actions and HTTP methods</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#redirections-and-404-errors">Redirections and 404 errors</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#includes">Includes</a>
            
        </li>
    
        <li>
            <a href="/docs/actions.html#calling-actions-programmatically">Calling actions programmatically</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/views.html#views">Views</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/views.html#views">Views</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#layout">Layout</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#view-contexts">View contexts</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#controlling-views">Controlling views</a>
            
        </li>
    
        <li>
            <a href="/docs/views.html#rendering-views-programmatically">Rendering views programmatically</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/helpers.html#helpers">Helpers</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/helpers.html#creating-helpers">Creating helpers</a>
            
        </li>
    
        <li>
            <a href="/docs/helpers.html#using-helpers">Using helpers</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/utilities.html#utilities">Utilities</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/utilities.html#escaping-text">Escaping text</a>
            
        </li>
    
        <li>
            <a href="/docs/utilities.html#friendly-urls">Friendly urls</a>
            
        </li>
    
        <li>
            <a href="/docs/utilities.html#filtering-and-validating-data">Filtering and validating data</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/using-plugins.html#using-plugins">Using plugins</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/using-plugins.html#installing-a-plugin">Installing a plugin</a>
            
        </li>
    
        <li>
            <a href="/docs/using-plugins.html#activating-and-configuring-a-plugin">Activating and configuring a plugin</a>
            
        </li>
    
        <li>
            <a href="/docs/using-plugins.html#pluggable-applications">Pluggable applications</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/session.html#session">Session</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/session.html#starting-and-accessing-the-session">Starting and accessing the session</a>
            
        </li>
    
        <li>
            <a href="/docs/session.html#flash-messages">Flash messages</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/error-log-debug.html#error-handling-logging-and-debugging">Error handling, logging and debugging</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/error-log-debug.html#handling-errors">Handling errors</a>
            
        </li>
    
        <li>
            <a href="/docs/error-log-debug.html#logging">Logging</a>
            
        </li>
    
        <li>
            <a href="/docs/error-log-debug.html#debugging">Debugging</a>
            
        </li>
    
        <li>
            <a href="/docs/error-log-debug.html#debug-bar">Debug Bar</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/database.html#database">Database</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/database.html#connecting">Connecting</a>
            
        </li>
    
        <li>
            <a href="/docs/database.html#querying-data">Querying data</a>
            
        </li>
    
        <li>
            <a href="/docs/database.html#manipulating-data">Manipulating data</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/scripts.html#scripts">Scripts</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/scripts.html#creating-custom-scripts">Creating custom scripts</a>
            
        </li>
    
        <li>
            <a href="/docs/scripts.html#registering-commands">Registering commands</a>
            
        </li>
    
        <li>
            <a href="/docs/scripts.html#built-in-commands">Built-in commands</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/translations.html#translations">Translations</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/translations.html#creating-language-files">Creating language files</a>
            
        </li>
    
        <li>
            <a href="/docs/translations.html#detecting-the-user-language">Detecting the user language</a>
            
        </li>
    
        <li>
            <a href="/docs/translations.html#translating-strings">Translating strings</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/controllers.html#controller">Controller</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/controllers.html#differences-with-the-classic-atomik-way">Differences with the classic Atomik way</a>
            
        </li>
    
        <li>
            <a href="/docs/controllers.html#creating-controllers">Creating controllers</a>
            
        </li>
    
        <li>
            <a href="/docs/controllers.html#using-controllers-in-pluggable-apps">Using controllers in Pluggable Apps</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/events.html#events">Events</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/events.html#listening-to-events">Listening to events</a>
            
        </li>
    
        <li>
            <a href="/docs/events.html#firing-events">Firing events</a>
            
        </li>
    
        <li>
            <a href="/docs/events.html#events-naming-convention">Events naming convention</a>
            
        </li>
    
</ol>

            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#developing-plugins">Developing plugins</a>
            
                
    <ol>
    
        <li>
            <a href="/docs/developing-plugins.html#the-plugin-file">The plugin file</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#configuration">Configuration</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#using-a-class">Using a class</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#pluggable-applications">Pluggable applications</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#assets-and-urls">Assets and urls</a>
            
        </li>
    
        <li>
            <a href="/docs/developing-plugins.html#loading-plugins-programmaticaly">Loading plugins programmaticaly</a>
            
        </li>
    
</ol>

            
        </li>
    
</ol>

    </nav>
    
    <nav id="links">
        <ul>
            
        </ul>
    </nav>
    
</div>

        <div id="content">
            <a name="actions"></a><h1>Actions</h1>
<a name="introduction"></a><h2>Introduction</h2>
<p>Without using Atomik, one way of doing things would have been to create a file
per page. The page logic (i.e. connecting to a database, handling form data...) would
have been at the top of the file followed by the HTML. </p>
<pre><code>&lt;?php
    if (count($_POST)) {
        echo &#39;Form data received!&#39;;
    }
?&gt;
&lt;form&gt;
    &lt;input type=&quot;text&quot; name=&quot;data&quot; /&gt;
    &lt;input type=&quot;submit&quot; value=&quot;send&quot; /&gt;
&lt;/form&gt;</code></pre>
<p>This is BAD!! The application logic and the presentation layer should always be separated
as explained <a href="http://en.wikipedia.org/wiki/Separation_of_concerns">here</a>.</p>
<p>Now let&#39;s imagine that rather than directly doing both part in the same file we split it.
We would have three file: one with the logic, one with the HTML and one that include both.</p>
<pre><code>// page_logic.php

&lt;?php
if (count($_POST)) {
    echo &#39;Form data received!&#39;;
}

// page_html.php

&lt;form&gt;
    &lt;input type=&quot;text&quot; name=&quot;data&quot; /&gt;
    &lt;input type=&quot;submit&quot; value=&quot;send&quot; /&gt;
&lt;/form&gt;

// page.php

&lt;?php
include &#39;page_logic.php&#39;;
include &#39;page_html.php&#39;;</code></pre>
<p>Now replace the third file (the one with the includes) with Atomik and you&#39;ll have the concept
behind Atomik. The logic script is named an action and the html a view.</p>
<a name="action-files"></a><h2>Action files</h2>
<p>Actions are stored in the <em>app/actions</em> directory. Both the action and the 
view filename must be the same. Action files must have the <em>php</em> extension.
If the action or view filename starts with an underscore, the action won&#39;t be accessible using an url.</p>
<p>There are no requirements for the content of an action file. It can be anything you want. 
So you just do your logic as you used to.</p>
<p>Be aware that actions run in their own scope and not in the global scope as you
might think.</p>
<p>Variables declared in the action are forwarded to the view. If you want to keep some
variables private (i.e. which will only be available in your action) prefixed them
with an underscore.</p>
<pre><code>&lt;?php
$myPublicVariable = &#39;value&#39;;
$_myPrivateVariable = &#39;secret&#39;;</code></pre>
<p>You shouldn&#39;t use echo or write any HTML code inside an action.
As said before, the goal of an action is to separate the logic from the presentation.</p>
<p>If you would like to exit the application, avoid using exit() and prefer
<code>Atomik::end()</code> so Atomik can smoothly exit your application.</p>
<p>You can use folders to organize your actions. In this case, views must follow the same
directory structure. You can create an <em>index</em> action (<em>index.php</em>)
inside a folder and it will be use as the folder&#39;s default page. Views follow the same principle.</p>
<pre><code>app/actions/users.php           &lt;- will be used if url = /users
app/actions/users/index.php     &lt;- will be used if url = /users AND if app/actions/users.php does not exist
app/actions/users/messages.php  &lt;- will be used if url = /users/messages whatever the default page is</code></pre>
<a name="actions-and-http-methods"></a><h2>Actions and HTTP methods</h2>
<p>Atomik allows you to create multiple files for one action, each of them targeting a specific HTTP
method. This enables RESTful websites to be build.</p>
<a name="targeting-http-methods"></a><h3>Targeting HTTP methods</h3>
<p>Method specific action files must be suffixed with the method name. So for example, if you have
a <em>user</em> action and you would like to target the POST method, you would create a
file named <em>user.post.php</em>. With the PUT method it would have been
<em>user.put.php</em>. These files must be located in the actions folder.</p>
<p>You can still create a global action file (in the previous example: <em>user.php</em>)
which will be executed before any method specific action. Variables from the global action are
available in the specific one.</p>
<p>The current http method is available in the <em>app.http_method</em> configuration key.</p>
<a name="allowed-methods-and-overriding-the-requests-method"></a><h3>Allowed methods and overriding the request&#39;s method</h3>
<p>Allowed HTTP methods are defined in <em>app.allowed_http_methods</em>. By default,
all methods available in the protocol are listed but you may want to reduce that list.</p>
<p>Some clients does not handle well HTTP methods. Thus, it is possible
to override the request&#39;s method using a route parameter (which can be a GET parameter).
The default parameter name is <em>_method</em>. This can be changed in
<em>app.http_method_param</em>. It can also be disabled by setting false instead of
a string.</p>
<a name="redirections-and-404-errors"></a><h2>Redirections and 404 errors</h2>
<p>To redirect the user to another page you can use the <code>Atomik::redirect()</code> method.
It takes as argument the url to redirect to. By default, this url will first be process using 
<code>Atomik::url()</code>. This behaviour can be disabled by passing false as the second argument.
The response HTTP code can also be specified as the third argument.</p>
<pre><code>$this-&gt;redirect(&#39;home&#39;);
$this-&gt;redirect(&#39;home&#39;, true, 303); // 303 http code</code></pre>
<p>Triggering 404 errors is even simpler. Just call the <code>Atomik::trigger404()</code> method.</p>
<pre><code>$this-&gt;trigger404();</code></pre>
<a name="includes"></a><h2>Includes</h2>
<p>Includes are php files containing common logic that you include in your actions.</p>
<p>Includes are stored either in <em>app/includes</em> or <em>app/libs</em>.
directories. This can be changed in <em>atomik.dirs.includes</em>.</p>
<p>To include a file from one of these directories use the <code>Atomik::needed()</code> 
method. It takes as first argument the path to the filename you wish to include relative to the
previous directories and without the extension.</p>
<pre><code>// includes app/includes/common.php
Atomik::needed(&#39;common&#39;);</code></pre>
<p>You can use sub directories. To include a file stored at <em>app/includes/libs/db.php</em>:</p>
<pre><code>Atomik::needed(&#39;libs/db&#39;);</code></pre>
<p><code>Atomik::needed()</code> also allows you to include classes using
their name. To do so, classes have to follow the PEAR naming convention
(<a href="http://pear.php.net/manual/en/standards.naming.php">http://pear.php.net/manual/en/standards.naming.php</a>) or use PHP 5.3 namespaces.</p>
<pre><code>// app/libraries/Atomik/Db.php
Atomik::needed(&#39;Atomik_Db&#39;);
Atomik::needed(&#39;Atomik\Db&#39;);</code></pre>
<p><code>Atomik::needed()</code> is automatically registered as an spl_autoload handler.
This can be modified by setting <em>false</em> to the configuration key named <em>atomik.class_autoload</em>.</p>
<a name="calling-actions-programmatically"></a><h2>Calling actions programmatically</h2>
<p>When executing a request, the action and/or the view associated to it are
automatically called. You can however call other actions using Atomik&#39;s API.</p>
<p>To execute an action use the <code>Atomik::execute()</code> method. It takes
as first argument the action name.</p>
<p>By default, if a view with the same name is found, it is rendered and the return value
of the <code>execute()</code> method is the view output.</p>
<p>If no view is found, an empty string is returned. If false is used as second argument, 
the return value is an array containing all <em>public</em> variables from the action.</p>
<pre><code>$viewOutput = Atomik::execute(&#39;myAction&#39;);
$variables = Atomik::execute(&#39;myAction&#39;, false);</code></pre>
<p>Calling an action using <code>Atomik::execute()</code> does not mean an action file
must exist. However, in this case, a view file with the same name must exist. Otherwise,
an exception will be thrown.</p>
<p>Actions executed this way will also be influenced by the HTTP method. You can specify a specific method
by appendinf it to the action name. The global action will also be executed.</p>
<pre><code>$viewOutput = Atomik::execute(&#39;myAction.post&#39;);</code></pre>




        </div>
        <footer id="footer">
            Powered by <a href="http://github.com/maximebf/beautiful-docs">beautiful-docs</a> -
            <a href="#top">Back to top</a> - <a href="/docs/all.html">Everything on a single page</a>
            - <a href="?print=1">Print current page</a> - <a href="/docs/all.html?print=1">Print all pages</a>
            
        </footer>
    </div>
</body>
</html>
