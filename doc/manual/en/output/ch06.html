<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Chapter 6. Actions and templates</title>
    <link rel="stylesheet" href="styles.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="start" href="index.html" title="Atomik Framework Manual" />
    <link rel="up" href="index.html" title="Atomik Framework Manual" />
    <link rel="prev" href="ch05.html" title="Chapter 5. URLs" />
    <link rel="next" href="ch07.html" title="Chapter 7. Selectors" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">Chapter 6. Actions and templates</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="ch05.html">Prev</a> </td>
          <th width="60%" align="center"> </th>
          <td width="20%" align="right"> <a accesskey="n" href="ch07.html">Next</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="actions-templates"></a>Chapter 6. Actions and templates</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch06.html#actions-templates-introduction">Introduction</a></span></dt><dt><span class="sect1"><a href="ch06.html#actions">Actions</a></span></dt><dt><span class="sect1"><a href="ch06.html#templates">Templates</a></span></dt><dt><span class="sect1"><a href="ch06.html#actions-templates-programmatically">Calling actions or templates programmatically</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch06.html#executing-actions">Executing actions</a></span></dt><dt><span class="sect2"><a href="ch06.html#rendering-templates">Rendering templates</a></span></dt></dl></dd></dl></div>
	
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="actions-templates-introduction"></a>Introduction</h2></div></div></div>
		
		<p>
			Without using Atomik, one way of doing things would have been to create a file
			per page. The page logic (i.e. connecting to a database, handling form data...) would
			have been at the top of the file followed by the HTML. 
		</p>
		<div class="example"><a id="id3366913"></a><p class="title"><b>Example 6.1. A php script, the old way</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
&lt;?php
	if (count($_POST)) {
		echo 'Form data received!';
	}
?&gt;
&lt;form&gt;
	&lt;input type="text" name="data" /&gt;
	&lt;input type="submit" value="send" /&gt;
&lt;/form&gt;
			</pre>
		</div></div><br class="example-break" />
		<p>
			This is BAD!! The application logic and the presentation layer should always be separated.
		</p>
		<p>
			Now let's imagine that rather than directly doing both part in the same file we split it.
			We would have three file: one with the logic, one with the HTML and on that include both.
		</p>
		<div class="example"><a id="id3366939"></a><p class="title"><b>Example 6.2. Splitting into multiple files</b></p><div class="example-contents">
			
			<p>
				page_logic.php
			</p>
			<pre class="programlisting">
				
&lt;?php
if (count($_POST)) {
	echo 'Form data received!';
}
			</pre>
			<p>
				page_html.php
			</p>
			<pre class="programlisting">
				
&lt;form&gt;
	&lt;input type="text" name="data" /&gt;
	&lt;input type="submit" value="send" /&gt;
&lt;/form&gt;
			</pre>
			<p>
				page.php
			</p>
			<pre class="programlisting">
				
&lt;?php
include 'page_logic.php';
include 'page_html.php';
			</pre>
		</div></div><br class="example-break" />
		<p>
			Now replace the third file (the one with the includes) with Atomik and you'll have the concept
			behind Atomik. The logic script is named an action and the html a template.
		</p>
	</div>
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="actions"></a>Actions</h2></div></div></div>
		
		<p>
			Actions are stored in the <code class="filename">app/actions</code> directory. Both the action and the 
			template filename must have the same name.
		</p>
		<p>
			The content of the action file is free. It can be anything you want. So you just do your
			logic as you used to.
		</p>
		<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
			Be aware that action run in their own scope and not in the global scope as you
			might think.
		</div>
		<p>
			Variables declare in the action are forwarded to the template. If you want to keep some
			variables private (i.e. which will only be available in your action) prefixed them
			with an underscore.
		</p>
		<div class="example"><a id="id3367018"></a><p class="title"><b>Example 6.3. Private variables in actions</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
&lt;?php
$myPublicVariable = 'value';
$_myPrivateVariable = 'secret';
			</pre>
		</div></div><br class="example-break" />
		<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
			You shouldn't use <code class="function">echo</code> or write any HTML code inside an action.
			As said before, the goal of an action is to separate the logic from the presentation. Thus
			mix-in both in the action file would be a non-sense!
		</div>
	</div>
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="templates"></a>Templates</h2></div></div></div>
		
		<p>
			Templates are stored in the <code class="filename">app/templates</code> directory.
		</p>
		<p>
			The content of the template file is, as the action file, free. It should mostly be text or 
			HTML (or any presentation content, such as XML).
		</p>
		<p>
			PHP can be used to print variables from the action or to provide presentation logic like
			loops.
		</p>
		<div class="example"><a id="id3367071"></a><p class="title"><b>Example 6.4. Example template</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
&lt;html&gt;
	&lt;head&gt;
		&lt;title&gt;Example&lt;/title&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;?php echo $myPublicVariable; ?&gt;
	&lt;/body&gt;
&lt;/html&gt;
			</pre>
		</div></div><br class="example-break" />
		<div class="figure"><a id="id3367084"></a><p class="title"><b>Figure 6.1. A little schema to sum up!</b></p><div class="figure-contents">
			
			<div class="mediaobject"><img src="images/actions_templates.png" alt="A little schema to sum up!" /></div>
		</div></div><br class="figure-break" />
	</div>
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="actions-templates-programmatically"></a>Calling actions or templates programmatically</h2></div></div></div>
		
		<p>
			When executing a request, the action and/or the template associated to it are
			automatically called. You can however call other actions or render other
			templates using Atomik's API.
		</p>
		<p>
			The most useful use of this it to render partial templates, small part of presentation
			code that is reusable.
		</p>
		<div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="executing-actions"></a>Executing actions</h3></div></div></div>
			
			<p>
				To execute an action use the <code class="methodname">Atomik::execute()</code> method. It takes
				as first argument the action name.
			</p>
			<p>
				By default, if a template with the same name is found, it is rendered and the return value
				of the <code class="methodname">execute()</code> method is the template output.
			</p>
			<p>
				If no template is found or <code class="code">false</code> is used as second argument, the return value
				is an array containing all “<span class="quote">public</span>” variables from the action.
			</p>
			<div class="example"><a id="id3367174"></a><p class="title"><b>Example 6.5. Calling an action programmatically</b></p><div class="example-contents">
				
				<pre class="programlisting">
					
$templateOutput = Atomik::execute('myAction');
$variables = Atomik::execute('myAction', false);
				</pre>
			</div></div><br class="example-break" />
		</div>
		<div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rendering-templates"></a>Rendering templates</h3></div></div></div>
			
			<p>
				To render a template use the <code class="methodname">Atomik::render()</code> method.
			</p>
			<p>
				It takes as first argument the template name and optionally as second argument
				an array of key/value pairs representing variables.
			</p>
			<p>
				The method returns the template output.
			</p>
			<div class="example"><a id="id3367215"></a><p class="title"><b>Example 6.6. Rendering a template programmatically</b></p><div class="example-contents">
				
				<pre class="programlisting">
					
$templateOutput = Atomik::render('myTemplate');
$templateOutput = Atomik::render('myTemplate', array('var' =&gt; 'value'));
				</pre>
			</div></div><br class="example-break" />
		</div>
		<p>
			For more information on both methods, see the API reference.
		</p>
	</div>
</div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="ch05.html">Prev</a> </td>
          <td width="20%" align="center"> </td>
          <td width="40%" align="right"> <a accesskey="n" href="ch07.html">Next</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">Chapter 5. URLs </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Home</a>
          </td>
          <td width="40%" align="right" valign="top"> Chapter 7. Selectors</td>
        </tr>
      </table>
    </div>
  </body>
</html>
