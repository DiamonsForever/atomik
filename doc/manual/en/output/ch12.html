<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Chapter 12. Events</title>
    <link rel="stylesheet" href="styles.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="start" href="index.html" title="Atomik Framework Manual" />
    <link rel="up" href="index.html" title="Atomik Framework Manual" />
    <link rel="prev" href="ch11.html" title="Chapter 11. Error handling and debugging" />
    <link rel="next" href="ch13.html" title="Chapter 13. Plugins" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">Chapter 12. Events</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="ch11.html">Prev</a> </td>
          <th width="60%" align="center"> </th>
          <td width="20%" align="right"> <a accesskey="n" href="ch13.html">Next</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="chapter" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="events"></a>Chapter 12. Events</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch12.html#listening-events">Listening to events</a></span></dt><dt><span class="sect1"><a href="ch12.html#firing-events">Firing events</a></span></dt><dt><span class="sect1"><a href="ch12.html#events-naming-convention">Events naming convention</a></span></dt><dt><span class="sect1"><a href="ch12.html#events-schema">Overview of available Atomik events</a></span></dt></dl></div>
	
	<p>
		Events are one of the most important concept in Atomik.
		Callback can be registered to listen on any events. When an event
		is fired (or triggered), all listening callbacks are called. 
	</p>
	<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
		Events are implicitely declared when they're fired.
	</div>
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="listening-events"></a>Listening to events</h2></div></div></div>
		
		<p>
			Atomik provides the <code class="methodname">listenEvent</code> method.
			It takes as first argument an event name and as second a callback.
			See <a class="ulink" href="http://php.net/callback" target="_top">http://php.net/callback</a> 
			for more information on callbacks.
		</p>
		<div class="example"><a id="id1207447"></a><p class="title"><b>Example 12.1. Listening to an event</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
function myEventCallback()
{
	// ...
}

function myArgEventCallback($arg1, $arg2)
{
	// ...
}

Atomik::listenEvent('myEvent', 'myEventCallback');
Atomik::listenEvent('myArgEvent', 'myArgEventCallback');
			</pre>
		</div></div><br class="example-break" />
		<p>
			Listeners also have priorities. The priority is a number, smaller number have a higher priority.
			The priority is specified when registering the listener.
		</p>
		<div class="example"><a id="id1207467"></a><p class="title"><b>Example 12.2. Listeners with priorities</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
Atomik::listenEvent('myEvent', 'myEventCallback', 10);
Atomik::listenEvent('myEvent', 'myEventCallback2', 5); // will be called first
			</pre>
		</div></div><br class="example-break" />
		<p>
			Multiple listeners can have the same priority. If you dim your listener more important and want it 
			to be called before other listeners of the same priority, you can. This is done by passing true as
			the fourth parameter.
		</p>
		<div class="example"><a id="id1207484"></a><p class="title"><b>Example 12.3. Listeners with priorities and importance</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
Atomik::listenEvent('myEvent', 'myEventCallback', 10);
Atomik::listenEvent('myEvent', 'myEventCallback2', 10, true); // will be called first
			</pre>
		</div></div><br class="example-break" />
	</div>
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="firing-events"></a>Firing events</h2></div></div></div>
		
		<p>
			Events are fired using the <code class="methodname">fireEvent</code> method
			provided by Atomik. It takes as first argument the event name and
			optionally as second an array of arguments for callbacks.
		</p>
		<div class="example"><a id="id1207515"></a><p class="title"><b>Example 12.4. Firing events</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
Atomik::fireEvent('myEvent');
Atomik::fireEvent('myArgEvent', array('arg1Value', 'arg2Value'));
			</pre>
		</div></div><br class="example-break" />
		<p>
			This method returns an array with results from each callbacks. A string can also be returned
			when passing true as the third parameter. The string will be the concatanation of all results.
		</p>
		<div class="example"><a id="id1207533"></a><p class="title"><b>Example 12.5. Callback results after firing events</b></p><div class="example-contents">
			
			<pre class="programlisting">
				
$results = Atomik::fireEvent('myEvent'); // array
$string = Atomik::fireEvent('myStringEvent', array(), true); // string
			</pre>
		</div></div><br class="example-break" />
	</div>
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="events-naming-convention"></a>Events naming convention</h2></div></div></div>
		
		<p>
			While events name can be anything you want, Atomik uses a naming convention for its own events.
		</p>
		<p>
			Events are composed using “<span class="quote">Atomik</span>” or a plugin name, followed by the method from which the
			event was fired and optionnally the event name. Each part is separated using ":" twice and should
			start with an upper case.
		</p>
		<div class="example"><a id="id1207566"></a><p class="title"><b>Example 12.6. Example of event naming</b></p><div class="example-contents">
			
			<p>
				The method <code class="methodname">Atomik::dispatch()</code>
				fires an event named “<span class="quote">Atomik::Dispatch::Start</span>”.
			</p>
		</div></div><br class="example-break" />
	</div>
	<div class="sect1" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="events-schema"></a>Overview of available Atomik events</h2></div></div></div>
		
		<div class="figure"><a id="id1207594"></a><p class="title"><b>Figure 12.1. Simple schema illustrating Atomik events flow</b></p><div class="figure-contents">
			
			<div class="mediaobject"><img src="images/events.png" alt="Simple schema illustrating Atomik events flow" /></div>
		</div></div><br class="figure-break" />
	</div>
</div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="ch11.html">Prev</a> </td>
          <td width="20%" align="center"> </td>
          <td width="40%" align="right"> <a accesskey="n" href="ch13.html">Next</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">Chapter 11. Error handling and debugging </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Home</a>
          </td>
          <td width="40%" align="right" valign="top"> Chapter 13. Plugins</td>
        </tr>
      </table>
    </div>
  </body>
</html>
