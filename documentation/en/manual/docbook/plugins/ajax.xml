<?xml version="1.0" encoding="UTF-8"?>
<chapter id="ajax" xmlns="http://docbook.org/ns/docbook">
	<title>Ajax</title>
	<para>
		The Ajax plugin allows you to call your actions using a javascript's XmlHttpRequest and sending back
		json or the view without the layout.
	</para>
	<para>
		For the plugin to be activated, the request must have the <quote>X-Requested-With</quote> HTTP header.
		Nearly all javascript frameworks add this header.
	</para>
	<para>
		When this header is detected, the layout will be automatically disabled. This can be avoided by setting
		the <quote>disable_layout</quote> configuration key to false.
	</para>
	<para>
		It is also possible to return action variables as JSON instead of the view content. For that, you need
		to add action names in the allowed key.
	</para>
	<example>
		<title>Render views instead of returning variables</title>
		<programlisting>
			<![CDATA[
Atomik::set('plugins/Ajax', array(
	'allowed' => array(
		'my-action'
	);
));]]>
		</programlisting>
	</example>
	<para>
		This behaviour can be set as the default one by setting true to <quote>allow_all</quote>.
		In this case, variables will always be returned. It is then possible to disable this behaviour on a per
		action basis using the <quote>restricted</quote> configuration key.
	</para>
	<para>
		You can check if the current request is using AJAX by calling <methodname>AjaxPlugin::isEnabled()</methodname>.
	</para>
	<para>
		Flash messages are also returned as an HTTP header. It is named <quote>Flash-messages</quote> and contains
		an array encoded in javascript.
	</para>
</chapter>